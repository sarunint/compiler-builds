{"version":3,"file":"xliff2.js","sourceRoot":"","sources":["../../../../../../../packages/compiler/src/i18n/serializers/xliff2.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport * as ml from '../../ml_parser/ast';\nimport {XmlParser} from '../../ml_parser/xml_parser';\nimport {decimalDigest} from '../digest';\nimport * as i18n from '../i18n_ast';\nimport {I18nError} from '../parse_util';\n\nimport {Serializer} from './serializer';\nimport * as xml from './xml_helper';\n\nconst _VERSION = '2.0';\nconst _XMLNS = 'urn:oasis:names:tc:xliff:document:2.0';\n// TODO(vicb): make this a param (s/_/-/)\nconst _DEFAULT_SOURCE_LANG = 'en';\nconst _PLACEHOLDER_TAG = 'ph';\nconst _PLACEHOLDER_SPANNING_TAG = 'pc';\nconst _MARKER_TAG = 'mrk';\n\nconst _XLIFF_TAG = 'xliff';\nconst _SOURCE_TAG = 'source';\nconst _TARGET_TAG = 'target';\nconst _UNIT_TAG = 'unit';\n\n// http://docs.oasis-open.org/xliff/xliff-core/v2.0/os/xliff-core-v2.0-os.html\nexport class Xliff2 extends Serializer {\n  write(messages: i18n.Message[], locale: string|null): string {\n    const visitor = new _WriteVisitor();\n    const units: xml.Node[] = [];\n\n    messages.forEach(message => {\n      const unit = new xml.Tag(_UNIT_TAG, {id: message.id});\n      const notes = new xml.Tag('notes');\n\n      if (message.description || message.meaning) {\n        if (message.description) {\n          notes.children.push(\n              new xml.CR(8),\n              new xml.Tag('note', {category: 'description'}, [new xml.Text(message.description)]));\n        }\n\n        if (message.meaning) {\n          notes.children.push(\n              new xml.CR(8),\n              new xml.Tag('note', {category: 'meaning'}, [new xml.Text(message.meaning)]));\n        }\n      }\n\n      message.sources.forEach((source: i18n.MessageSpan) => {\n        notes.children.push(new xml.CR(8), new xml.Tag('note', {category: 'location'}, [\n          new xml.Text(\n              `${source.filePath}:${source.startLine}${source.endLine !== source.startLine ? ',' + source.endLine : ''}`)\n        ]));\n      });\n\n      notes.children.push(new xml.CR(6));\n      unit.children.push(new xml.CR(6), notes);\n\n      const segment = new xml.Tag('segment');\n\n      segment.children.push(\n          new xml.CR(8), new xml.Tag(_SOURCE_TAG, {}, visitor.serialize(message.nodes)),\n          new xml.CR(6));\n\n      unit.children.push(new xml.CR(6), segment, new xml.CR(4));\n\n      units.push(new xml.CR(4), unit);\n    });\n\n    const file =\n        new xml.Tag('file', {'original': 'ng.template', id: 'ngi18n'}, [...units, new xml.CR(2)]);\n\n    const xliff = new xml.Tag(\n        _XLIFF_TAG, {version: _VERSION, xmlns: _XMLNS, srcLang: locale || _DEFAULT_SOURCE_LANG},\n        [new xml.CR(2), file, new xml.CR()]);\n\n    return xml.serialize([\n      new xml.Declaration({version: '1.0', encoding: 'UTF-8'}), new xml.CR(), xliff, new xml.CR()\n    ]);\n  }\n\n  load(content: string, url: string):\n      {locale: string, i18nNodesByMsgId: {[msgId: string]: i18n.Node[]}} {\n    // xliff to xml nodes\n    const xliff2Parser = new Xliff2Parser();\n    const {locale, msgIdToHtml, errors} = xliff2Parser.parse(content, url);\n\n    // xml nodes to i18n nodes\n    const i18nNodesByMsgId: {[msgId: string]: i18n.Node[]} = {};\n    const converter = new XmlToI18n();\n\n    Object.keys(msgIdToHtml).forEach(msgId => {\n      const {i18nNodes, errors: e} = converter.convert(msgIdToHtml[msgId], url);\n      errors.push(...e);\n      i18nNodesByMsgId[msgId] = i18nNodes;\n    });\n\n    if (errors.length) {\n      throw new Error(`xliff2 parse errors:\\n${errors.join('\\n')}`);\n    }\n\n    return {locale: locale !, i18nNodesByMsgId};\n  }\n\n  digest(message: i18n.Message): string { return decimalDigest(message); }\n}\n\nclass _WriteVisitor implements i18n.Visitor {\n  // TODO(issue/24571): remove '!'.\n  private _nextPlaceholderId !: number;\n\n  visitText(text: i18n.Text, context?: any): xml.Node[] { return [new xml.Text(text.value)]; }\n\n  visitContainer(container: i18n.Container, context?: any): xml.Node[] {\n    const nodes: xml.Node[] = [];\n    container.children.forEach((node: i18n.Node) => nodes.push(...node.visit(this)));\n    return nodes;\n  }\n\n  visitIcu(icu: i18n.Icu, context?: any): xml.Node[] {\n    const nodes = [new xml.Text(`{${icu.expressionPlaceholder}, ${icu.type}, `)];\n\n    Object.keys(icu.cases).forEach((c: string) => {\n      nodes.push(new xml.Text(`${c} {`), ...icu.cases[c].visit(this), new xml.Text(`} `));\n    });\n\n    nodes.push(new xml.Text(`}`));\n\n    return nodes;\n  }\n\n  visitTagPlaceholder(ph: i18n.TagPlaceholder, context?: any): xml.Node[] {\n    const type = getTypeForTag(ph.tag);\n\n    if (ph.isVoid) {\n      const tagPh = new xml.Tag(_PLACEHOLDER_TAG, {\n        id: (this._nextPlaceholderId++).toString(),\n        equiv: ph.startName,\n        type: type,\n        disp: `<${ph.tag}/>`,\n      });\n      return [tagPh];\n    }\n\n    const tagPc = new xml.Tag(_PLACEHOLDER_SPANNING_TAG, {\n      id: (this._nextPlaceholderId++).toString(),\n      equivStart: ph.startName,\n      equivEnd: ph.closeName,\n      type: type,\n      dispStart: `<${ph.tag}>`,\n      dispEnd: `</${ph.tag}>`,\n    });\n    const nodes: xml.Node[] = [].concat(...ph.children.map(node => node.visit(this)));\n    if (nodes.length) {\n      nodes.forEach((node: xml.Node) => tagPc.children.push(node));\n    } else {\n      tagPc.children.push(new xml.Text(''));\n    }\n\n    return [tagPc];\n  }\n\n  visitPlaceholder(ph: i18n.Placeholder, context?: any): xml.Node[] {\n    const idStr = (this._nextPlaceholderId++).toString();\n    return [new xml.Tag(_PLACEHOLDER_TAG, {\n      id: idStr,\n      equiv: ph.name,\n      disp: `{{${ph.value}}}`,\n    })];\n  }\n\n  visitIcuPlaceholder(ph: i18n.IcuPlaceholder, context?: any): xml.Node[] {\n    const cases = Object.keys(ph.value.cases).map((value: string) => value + ' {...}').join(' ');\n    const idStr = (this._nextPlaceholderId++).toString();\n    return [new xml.Tag(\n        _PLACEHOLDER_TAG,\n        {id: idStr, equiv: ph.name, disp: `{${ph.value.expression}, ${ph.value.type}, ${cases}}`})];\n  }\n\n  serialize(nodes: i18n.Node[]): xml.Node[] {\n    this._nextPlaceholderId = 0;\n    return [].concat(...nodes.map(node => node.visit(this)));\n  }\n}\n\n// Extract messages as xml nodes from the xliff file\nclass Xliff2Parser implements ml.Visitor {\n  // TODO(issue/24571): remove '!'.\n  private _unitMlString !: string | null;\n  // TODO(issue/24571): remove '!'.\n  private _errors !: I18nError[];\n  // TODO(issue/24571): remove '!'.\n  private _msgIdToHtml !: {[msgId: string]: string};\n  private _locale: string|null = null;\n\n  parse(xliff: string, url: string) {\n    this._unitMlString = null;\n    this._msgIdToHtml = {};\n\n    const xml = new XmlParser().parse(xliff, url, false);\n\n    this._errors = xml.errors;\n    ml.visitAll(this, xml.rootNodes, null);\n\n    return {\n      msgIdToHtml: this._msgIdToHtml,\n      errors: this._errors,\n      locale: this._locale,\n    };\n  }\n\n  visitElement(element: ml.Element, context: any): any {\n    switch (element.name) {\n      case _UNIT_TAG:\n        this._unitMlString = null;\n        const idAttr = element.attrs.find((attr) => attr.name === 'id');\n        if (!idAttr) {\n          this._addError(element, `<${_UNIT_TAG}> misses the \"id\" attribute`);\n        } else {\n          const id = idAttr.value;\n          if (this._msgIdToHtml.hasOwnProperty(id)) {\n            this._addError(element, `Duplicated translations for msg ${id}`);\n          } else {\n            ml.visitAll(this, element.children, null);\n            if (typeof this._unitMlString === 'string') {\n              this._msgIdToHtml[id] = this._unitMlString;\n            } else {\n              this._addError(element, `Message ${id} misses a translation`);\n            }\n          }\n        }\n        break;\n\n      case _SOURCE_TAG:\n        // ignore source message\n        break;\n\n      case _TARGET_TAG:\n        const innerTextStart = element.startSourceSpan !.end.offset;\n        const innerTextEnd = element.endSourceSpan !.start.offset;\n        const content = element.startSourceSpan !.start.file.content;\n        const innerText = content.slice(innerTextStart, innerTextEnd);\n        this._unitMlString = innerText;\n        break;\n\n      case _XLIFF_TAG:\n        const localeAttr = element.attrs.find((attr) => attr.name === 'trgLang');\n        if (localeAttr) {\n          this._locale = localeAttr.value;\n        }\n\n        const versionAttr = element.attrs.find((attr) => attr.name === 'version');\n        if (versionAttr) {\n          const version = versionAttr.value;\n          if (version !== '2.0') {\n            this._addError(\n                element,\n                `The XLIFF file version ${version} is not compatible with XLIFF 2.0 serializer`);\n          } else {\n            ml.visitAll(this, element.children, null);\n          }\n        }\n        break;\n      default:\n        ml.visitAll(this, element.children, null);\n    }\n  }\n\n  visitAttribute(attribute: ml.Attribute, context: any): any {}\n\n  visitText(text: ml.Text, context: any): any {}\n\n  visitComment(comment: ml.Comment, context: any): any {}\n\n  visitExpansion(expansion: ml.Expansion, context: any): any {}\n\n  visitExpansionCase(expansionCase: ml.ExpansionCase, context: any): any {}\n\n  private _addError(node: ml.Node, message: string): void {\n    this._errors.push(new I18nError(node.sourceSpan, message));\n  }\n}\n\n// Convert ml nodes (xliff syntax) to i18n nodes\nclass XmlToI18n implements ml.Visitor {\n  // TODO(issue/24571): remove '!'.\n  private _errors !: I18nError[];\n\n  convert(message: string, url: string) {\n    const xmlIcu = new XmlParser().parse(message, url, true);\n    this._errors = xmlIcu.errors;\n\n    const i18nNodes = this._errors.length > 0 || xmlIcu.rootNodes.length == 0 ?\n        [] :\n        [].concat(...ml.visitAll(this, xmlIcu.rootNodes));\n\n    return {\n      i18nNodes,\n      errors: this._errors,\n    };\n  }\n\n  visitText(text: ml.Text, context: any) { return new i18n.Text(text.value, text.sourceSpan); }\n\n  visitElement(el: ml.Element, context: any): i18n.Node[]|null {\n    switch (el.name) {\n      case _PLACEHOLDER_TAG:\n        const nameAttr = el.attrs.find((attr) => attr.name === 'equiv');\n        if (nameAttr) {\n          return [new i18n.Placeholder('', nameAttr.value, el.sourceSpan)];\n        }\n\n        this._addError(el, `<${_PLACEHOLDER_TAG}> misses the \"equiv\" attribute`);\n        break;\n      case _PLACEHOLDER_SPANNING_TAG:\n        const startAttr = el.attrs.find((attr) => attr.name === 'equivStart');\n        const endAttr = el.attrs.find((attr) => attr.name === 'equivEnd');\n\n        if (!startAttr) {\n          this._addError(el, `<${_PLACEHOLDER_TAG}> misses the \"equivStart\" attribute`);\n        } else if (!endAttr) {\n          this._addError(el, `<${_PLACEHOLDER_TAG}> misses the \"equivEnd\" attribute`);\n        } else {\n          const startId = startAttr.value;\n          const endId = endAttr.value;\n\n          const nodes: i18n.Node[] = [];\n\n          return nodes.concat(\n              new i18n.Placeholder('', startId, el.sourceSpan),\n              ...el.children.map(node => node.visit(this, null)),\n              new i18n.Placeholder('', endId, el.sourceSpan));\n        }\n        break;\n      case _MARKER_TAG:\n        return [].concat(...ml.visitAll(this, el.children));\n      default:\n        this._addError(el, `Unexpected tag`);\n    }\n\n    return null;\n  }\n\n  visitExpansion(icu: ml.Expansion, context: any) {\n    const caseMap: {[value: string]: i18n.Node} = {};\n\n    ml.visitAll(this, icu.cases).forEach((c: any) => {\n      caseMap[c.value] = new i18n.Container(c.nodes, icu.sourceSpan);\n    });\n\n    return new i18n.Icu(icu.switchValue, icu.type, caseMap, icu.sourceSpan);\n  }\n\n  visitExpansionCase(icuCase: ml.ExpansionCase, context: any): any {\n    return {\n      value: icuCase.value,\n      nodes: [].concat(...ml.visitAll(this, icuCase.expression)),\n    };\n  }\n\n  visitComment(comment: ml.Comment, context: any) {}\n\n  visitAttribute(attribute: ml.Attribute, context: any) {}\n\n  private _addError(node: ml.Node, message: string): void {\n    this._errors.push(new I18nError(node.sourceSpan, message));\n  }\n}\n\nfunction getTypeForTag(tag: string): string {\n  switch (tag.toLowerCase()) {\n    case 'br':\n    case 'b':\n    case 'i':\n    case 'u':\n      return 'fmt';\n    case 'img':\n      return 'image';\n    case 'a':\n      return 'link';\n    default:\n      return 'other';\n  }\n}\n"]}